<html>

<head>
   <link href="https://unpkg.com/tabulator-tables@4.9.3/dist/css/tabulator.min.css" rel="stylesheet">
   <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.min.js"></script>
   <script src="https://wow.zamimg.com/widgets/power.js"></script>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<script>
   function openTab(tabName) {
      var i;
      var x = document.getElementsByClassName("tab");
      for (i = 0; i < x.length; i++) {
         x[i].style.display = "none";
      }
      document.getElementById(tabName).style.display = "block";
   }
</script>
<script>var whTooltips = { colorLinks: true, iconizeLinks: true, renameLinks: true };</script>


<br /><br />
<div>
   <button onclick="openTab('DKP')">DKP Table</button>
   <button onclick="openTab('DKPHistory')">DKP History</button>
   <button onclick="openTab('LootHistory')">Loot History</button>
</div>
<br /><br />
<div id="DKP" class="tab">
   <div id="dkp_table"></div>
   <!-- <div><object id="dkp_list" data="dkp.txt"></object></div> -->


</div>
<script>
   // let dkp_list = document.querySelector('#dkp_list');
   // console.log(dkp_list);

   jQuery.get('/dkp.txt', function (data) {
      alert(data);
   });

   //create Tabulator on DOM element with id "example-table"
   var table = new Tabulator("#dkp_table", {
      layout: "fitColumns", //fit columns to width of table (optional)
      columns: [ //Define Table Columns
         // player,class,DKP,previousDKP,lifetimeGained,lifetimeSpent
         { title: "Player", field: "player" },
         { title: "class", field: "class" },
         { title: "DKP", field: "DKP" },
         { title: "previousDKP", field: "previousDKP" },
         { title: "lifetimeGained", field: "lifetimeGained" },
         { title: "lifetimeSpent", field: "lifetimeSpent" },
      ],
      rowClick: function (e, row) { //trigger an alert message when the row is clicked
         alert("Row " + row.getData().id + " Clicked!!!!");
      },
   });
   function CSVToArray(strData, strDelimiter) {
      // Check to see if the delimiter is defined. If not,
      // then default to comma.
      strDelimiter = (strDelimiter || ",");

      // Create a regular expression to parse the CSV values.
      var objPattern = new RegExp(
         (
            // Delimiters.
            "(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +

            // Quoted fields.
            "(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +

            // Standard fields.
            "([^\"\\" + strDelimiter + "\\r\\n]*))"
         ),
         "gi"
      );


      // Create an array to hold our data. Give the array
      // a default empty first row.
      var arrData = [[]];

      // Create an array to hold our individual pattern
      // matching groups.
      var arrMatches = null;


      // Keep looping over the regular expression matches
      // until we can no longer find a match.
      while (arrMatches = objPattern.exec(strData)) {

         // Get the delimiter that was found.
         var strMatchedDelimiter = arrMatches[1];

         // Check to see if the given delimiter has a length
         // (is not the start of string) and if it matches
         // field delimiter. If id does not, then we know
         // that this delimiter is a row delimiter.
         if (
            strMatchedDelimiter.length &&
            strMatchedDelimiter !== strDelimiter
         ) {

            // Since we have reached a new row of data,
            // add an empty row to our data array.
            arrData.push([]);

         }

         var strMatchedValue;

         // Now that we have our delimiter out of the way,
         // let's check to see which kind of value we
         // captured (quoted or unquoted).
         if (arrMatches[2]) {

            // We found a quoted value. When we capture
            // this value, unescape any double quotes.
            strMatchedValue = arrMatches[2].replace(
               new RegExp("\"\"", "g"),
               "\""
            );

         } else {

            // We found a non-quoted value.
            strMatchedValue = arrMatches[3];

         }


         // Now that we have our value string, let's add
         // it to the data array.
         arrData[arrData.length - 1].push(strMatchedValue);
      }

      // Return the parsed data.
      return (arrData);
   }
</script>

</html>